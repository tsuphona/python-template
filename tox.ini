[tox]
requires =
    tox>=4.10.0
env_list = py{38, 310}-{pytest, linting, typing}

[testenv]
deps =
    -rrequirements.txt

[testenv:py{38, 310}-pytest]
description = run unit tests
skip_install = true
deps =
    pytest>=7.4.0
    pytest-sugar>=0.9.7
commands =
    python3 -m pytest -s -m "unit or integration"

[testenv:py{38, 310}-linting]
description = run linters
skip_install = true
deps =
    black==23.7.0
    flake8==6.1.0
commands =
    python3 -m black --check .
    python3 -m flake8 .

[testenv:py{38, 310}-typing]
description = run type checks
skip_install = true
deps =
    mypy>=1.5.1
commands =
    python3 -m mypy {posargs:.}

[flake8]
max-line-length = 88
extend-ignore = E203
exclude =
    # The conf file is mostly autogenerated, ignore it
    docs/conf.py,
    # No need to check .tox directory
    .tox
